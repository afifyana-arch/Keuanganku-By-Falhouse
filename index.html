<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Keuanganku - Dashboard</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#739072">
    <style>
        /* [MODIFIKASI] Menambahkan font 'Dancing Script' */
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400&family=Poppins:wght@400;500;600;700&display=swap');
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        :root {
            --sidebar-width: 220px;
            
            --sidebar-bg: #FFFFFF;
            
            /* Palet Hijau Sage */
            --sidebar-link-color: #8A94A6; 
            --sidebar-link-hover: #F3F5F3;      
            --sidebar-link-active: #739072;     

            --main-bg: #F1F3F9; 
            --text-dark: #1E202C;
            --text-gray: #8A94A6;
            
            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);

            /* --- [BARU] Palet Warna Soft --- */
            --soft-green-bg: #EAF0E9;
            --soft-green-text: #4A5C4A;
            
            --soft-red-bg: #FDECEC;
            --soft-red-text: #B91C1C;
            
            --soft-blue-bg: #EBF5FF;
            --soft-blue-text: #2563EB;
            
            --soft-gray-bg: #F9FAFB;
            --soft-gray-text: #4B5563;
            --soft-gray-border: #E5E7EB;

            /* --- Pakem Tipografi (Font System) --- */
            --font-size-sm: 0.875rem;  /* 14px */
            --font-size-base: 1rem;     /* 16px - Teks standar, paragraf */
            --font-size-lg: 1.125rem;  /* 18px - Judul Card, Sub-heading kecil */
            --font-size-xl: 1.25rem;   /* 20px - Sub-heading (misal: "Catat Transaksi") */
            --font-size-xxl: 1.5rem;   /* 24px - Judul Halaman Utama (Page Title) */
            --font-size-display: 2rem;  /* 32px - Angka Saldo Besar */
            
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
        }

        body {
            background-color: var(--main-bg);
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            overflow-x: hidden;
            
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-normal);
            line-height: 1.5;
            color: var(--text-dark); 
        }

        /* --- [BARU] Tombol Primer Tema Sage --- */
        .btn-brand-primary {
            background-color: var(--sidebar-link-active);
            border-color: var(--sidebar-link-active);
            color: #FFFFFF;
            font-weight: var(--font-weight-medium);
            transition: all 0.3s ease;
        }
        .btn-brand-primary:hover {
            background-color: #607A60; /* Sage gelap */
            border-color: #607A60;
            color: #FFFFFF;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        /* --- Akhir Tombol Primer --- */

        /* 1. Struktur Layout Utama */
        .wrapper {
            display: flex;
        }

        #main-content {
            flex-grow: 1;
            padding-left: var(--sidebar-width);
            transition: padding-left 0.3s ease;
        }

        /* 2. Sidebar (z-index: 1001) */
        #sidebar {
            width: var(--sidebar-width);
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            background-color: var(--sidebar-bg); 
            padding: 1.5rem 0.75rem; 
            transition: left 0.3s ease;
            overflow-y: auto;
            z-index: 1001;
            border-right: 1px solid #E5E7EB; 
        }

        /* [MODIFIKASI] CSS Header untuk Judul & Tagline */
        .sidebar-header {
            margin-bottom: 2rem; 
            text-align: left; 
            padding-left: 1.25rem; 
        }

        .sidebar-title {
            display: block;
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--text-dark); 
            line-height: 1.2;
        }
        
        .sidebar-title .bi {
            margin-right: 10px;
            color: var(--sidebar-link-active);
        }

        /* [CSS BARU] Untuk "by falhouse" */
        .sidebar-tagline {
            display: block;
            font-family: 'Dancing Script', cursive; /* Font script */
            font-style: italic; /* Italic */
            font-size: 0.95rem; /* Lebih kecil dari judul */
            color: var(--text-gray);
            font-weight: 400;
            line-height: 1;
            margin-top: -2px; /* Tarik sedikit ke atas */
            
            /* Sejajarkan dengan teks "Keuanganku" (sesuaikan jika ikon berubah) */
            padding-left: calc(1.25rem + 10px); 
        }
        /* --- Akhir Modifikasi CSS Header --- */

        .sidebar-nav {
            list-style: none;
            padding-left: 0;
        }

        .sidebar-link {
            display: block;
            padding: 0.75rem 1.25rem; 
            color: var(--sidebar-link-color); 
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            
            transition: background-color 0.3s ease, 
                        color 0.3s ease, 
                        padding-left 0.3s cubic-bezier(0.25, 1, 0.5, 1); 

            font-size: var(--font-size-sm); 
            font-weight: var(--font-weight-medium);
            white-space: nowrap; 
        }
        .sidebar-link .bi {
            margin-right: 0.75rem; 
            font-size: 1.1rem; 
        }

        .sidebar-link:hover {
            background-color: var(--sidebar-link-hover); 
            color: var(--sidebar-link-active); 
            padding-left: 1.6rem; 
        }

        .sidebar-link.active {
            background-color: var(--sidebar-link-active); 
            color: #FFFFFF; 
            font-weight: var(--font-weight-semibold);
            padding-left: 1.25rem; 
        }

        .sidebar-link.active:hover {
            background-color: var(--sidebar-link-active);
            color: #FFFFFF;
            padding-left: 1.25rem; 
            filter: brightness(1.1); 
        }

        /* 3. Topbar Konten */
        .content-topbar {
            background-color: #FFFFFF; 
            border-bottom: 1px solid #E5E7EB;
            padding: 1.5rem 2.5rem; 
            margin-bottom: 2.5rem;
            position: sticky;
            top: 0;
            z-index: 900;
        }
        
        #page-title {
            font-size: var(--font-size-xxl);
            font-weight: var(--font-weight-bold);
            color: var(--text-dark); 
        }

        /* 4. Konten (View) dengan Animasi */
        .app-view {
            display: none;
            opacity: 0;
            transition: opacity 0.4s ease-in-out;
            min-height: calc(100vh - 120px);
        }

        .app-view.active {
            display: block;
            opacity: 1;
        }

        /* Standarisasi Heading & Teks */
        h1, h2, h3, h4, h5, h6 {
            font-weight: var(--font-weight-bold);
            line-height: 1.3;
            margin-top: 0;
            margin-bottom: 0.75rem; 
        }

        h1 { font-size: var(--font-size-display); }     /* 32px */
        h2 { font-size: var(--font-size-xxl); }         /* 24px */
        h3 { font-size: var(--font-size-xl); }          /* 20px */
        h5 { font-size: var(--font-size-lg); }          /* 18px */
        h6 { font-size: var(--font-size-base); }        /* 16px */

        p, .form-text {
            font-size: var(--font-size-base);
            margin-bottom: 1rem;
            color: #6B7281;
        }
        
        .form-text {
            margin-bottom: 0;
        }

        label, .form-label {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold); 
            margin-bottom: 0.5rem;
            color: var(--text-dark); 
        }

        .form-control, .form-select {
            font-size: var(--font-size-base);
        }
        .form-control-lg, .form-select-lg {
            font-size: var(--font-size-lg);
        }

        /* 5. Perbaikan Tampilan Card */
        .card {
            border: none;
            border-radius: 20px; 
            box-shadow: var(--card-shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            height: 100%;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
        
        .card-title {
             font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            color: var(--text-gray) !important; 
            margin-bottom: 0.25rem !important;
        }
        .card-title.text-success .bi { color: #10B981; }
        .card-title.text-danger .bi { color: #EF4444; }
        .card-title.text-primary .bi { color: #3B82F6; }

        .card-balance {
            font-size: var(--font-size-display);
            font-weight: var(--font-weight-bold);
            color: var(--text-dark) !important; 
        }
        
        .table {
            --bs-table-striped-bg: #F9FAFB;
        }
        
        .table th {
            font-size: var(--font-size-sm);
            color: #6B7281;
            font-weight: var(--font-weight-semibold);
            text-transform: uppercase;
        }
        
        .table td {
            font-size: var(--font-size-base);
            vertical-align: middle;
        }
        
        /* [MODIFIKASI] Ubah warna text-success/danger/primary di tabel */
        .table .tx-income { color: var(--soft-green-text) !important; font-weight: 500; }
        .table .tx-expense { color: var(--soft-red-text) !important; font-weight: 500; }
        .table .tx-transfer { color: var(--soft-blue-text) !important; font-weight: 500; }

        /* [MODIFIKASI] Warna Progress Bar Budget (Menggunakan kelas Bootstrap) */
        .progress-bar.bg-success { background-color: var(--soft-green-text) !important; }
        .progress-bar.bg-warning { background-color: #FBBF24 !important; } /* Kuning standard */
        .progress-bar.bg-danger { background-color: var(--soft-red-text) !important; }
        .progress-bar.bg-info { background-color: var(--soft-blue-text) !important; }

        .action-buttons .btn {
            transition: transform 0.2s ease;
        }
        .action-buttons .btn:hover {
            transform: scale(1.1);
        }
        
        /* [BARU] Tombol Aksi Soft (Tabel Desktop) */
        .btn-action-soft {
            background-color: var(--soft-gray-bg);
            color: var(--soft-gray-text);
            border: 1px solid var(--soft-gray-border);
            padding: 0.3rem 0.6rem;
            font-size: 0.9rem;
            border-radius: 6px;
        }
        .btn-action-soft:hover {
            background-color: var(--soft-gray-border);
            color: var(--text-dark);
            transform: scale(1.05);
        }
        
        #btn-cancel-edit {
            display: none;
        }

        /* 6. CSS Responsif & Fitur Baru */
        #sidebar-toggle {
            display: none;
        }

        .savings-goal-card .progress, .debt-card .progress { 
            height: 1.5rem;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold);
        }

        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .sidebar-overlay.active {
            display: block;
            opacity: 1;
        }
        
        .form-field-group.hidden {
            display: none;
        }
        
        .form-section-block {
            background-color: #FFFFFF;
            border: 1px solid #E5E7EB;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }

        .custom-dropdown {
            position: relative;
            cursor: pointer;
        }
        .custom-dropdown-selected {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.65rem 1rem;
            background-color: #fff;
            border: 1px solid #ced4da;
            border-radius: 8px;
            font-size: var(--font-size-base);
        }
        .custom-dropdown-selected span {
            font-weight: 500;
            color: var(--text-dark);
        }
        .custom-dropdown-selected span.placeholder {
            color: #6C757D; 
            font-weight: 400;
            display:contents;
        }

        .custom-dropdown-options {
            display: none; 
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-top: 4px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1050; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .custom-dropdown-option {
            padding: 0.75rem 1rem;
            transition: background-color 0.2s ease;
            display: flex; 
            align-items: center; 
        }
        .custom-dropdown-option:hover {
            background-color: var(--sidebar-link-hover); 
        }
        
        .custom-dropdown-option .account-icon {
            font-size: 1.25rem;
            margin-right: 0.75rem;
            color: var(--sidebar-link-active); 
            width: 24px; 
            text-align: center;
        }
        .custom-dropdown-option .account-details {
            flex-grow: 1;
        }
        
        .custom-dropdown-option .account-name {
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-semibold);
            color: var(--text-dark);
            display: block; 
        }
        .custom-dropdown-option .account-balance {
            font-size: var(--font-size-sm);
            color: var(--text-gray);
            display: block; 
        }
        .custom-dropdown-option[data-balance-level="high"] .account-balance {
            color: #10B981; 
            font-weight: 500;
        }
        .custom-dropdown-option[data-balance-level="low"] .account-balance {
            color: #EF4444; 
        }
        .custom-dropdown:hover .custom-dropdown-selected .bi-arrow-repeat {
            animation: spin 1s linear infinite;
        }

        #accounts-list-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem; 
        }

        .account-card {
            background-color: #F9FAFB;
            border: 1px solid #E5E7EB;
            border-radius: 12px;
            padding: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }
        .account-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--card-shadow);
            background-color: #FFFFFF;
        }

        .account-card-info {
            display: flex;
            align-items: center;
            overflow: hidden; 
            margin-right: 0.5rem;
        }

        .account-card .account-icon {
            font-size: 2rem; 
            color: var(--sidebar-link-active); 
            margin-right: 1rem;
            width: 40px;
            text-align: center;
        }

        .account-card .account-details {
            display: flex;
            flex-direction: column;
            overflow: hidden; 
        }

        .account-card .account-name {
            font-size: var(--font-size-lg); 
            font-weight: var(--font-weight-semibold);
            color: var(--text-dark);
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis; 
        }

        .account-card .account-balance {
            font-size: var(--font-size-base); 
            color: var(--text-gray);
            font-weight: var(--font-weight-medium);
        }

        .account-card .action-buttons {
            display: flex;
            flex-shrink: 0; 
        }
        .account-card .action-buttons .btn {
            padding: 0.25rem 0.5rem; 
        }

        /* --- [CSS BARU] Tampilan Hybrid Riwayat --- */
        
        /* 1. Indikator Tipe Transaksi */
        .tx-indicator {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 999px; /* Pill shape */
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            gap: 0.5rem;
        }
        
        .tx-income {
            background-color: var(--soft-green-bg);
            color: var(--soft-green-text);
        }
        .tx-expense {
            background-color: var(--soft-red-bg);
            color: var(--soft-red-text);
        }
        .tx-transfer {
            background-color: var(--soft-blue-bg);
            color: var(--soft-blue-text);
        }

        /* 2. Kartu Riwayat (Mobile) */
        .history-card {
            background-color: #FFFFFF;
            border: 1px solid var(--soft-gray-border);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.03);
        }
        
        .history-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.75rem;
        }
        
        .history-card-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            overflow: hidden; /* Penting */
        }
        
        .history-card-icon {
            font-size: 1.5rem;
            padding: 0.5rem;
            border-radius: 8px;
            flex-shrink: 0; /* Mencegah ikon mengecil */
        }
        
        .history-card-details {
            overflow: hidden; /* Mencegah teks panjang pecah */
        }

        .history-card-category {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            color: var(--text-dark);
            line-height: 1.2;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .history-card-description {
            font-size: var(--font-size-sm);
            color: var(--text-gray);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .history-card-amount {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            flex-shrink: 0;
            margin-left: 0.5rem;
            white-space: nowrap; /* Mencegah jumlah turun baris */
        }
        .history-card-amount.income {
            color: var(--soft-green-text);
        }
        .history-card-amount.expense {
            color: var(--soft-red-text);
        }
        .history-card-amount.transfer {
            color: var(--soft-blue-text);
        }

        .history-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 0.75rem;
            border-top: 1px solid var(--soft-gray-border);
        }
        
        .history-card-meta {
            display: flex;
            gap: 1rem; /* Jarak antar Akun dan Tanggal */
            font-size: var(--font-size-sm);
            color: var(--text-gray);
            align-items: center;
            overflow: hidden; /* Mencegah footer pecah */
        }
        .history-card-meta span {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .history-card-actions .dropdown-toggle::after {
            display: none; /* Sembunyikan panah dropdown bootstrap */
        }
        .history-card-actions .btn {
            color: var(--text-gray);
        }
        .history-card-actions .btn:hover {
            color: var(--text-dark);
            background-color: var(--soft-gray-bg);
        }

        /* 3. Logika Tampilan Hybrid */
        .history-cards-view {
            display: none; /* Sembunyi di desktop */
        }
        /* --- Akhir CSS Riwayat --- */

        /* ========================================= */
        /* === PERBAIKAN RESPONSIVITAS MOBILE     === */
        /* ========================================= */

        /* 1. Perbaikan container utama */
        .container-fluid {
            padding-left: 0.75rem;
            padding-right: 0.75rem;
        }

        /* 2. Perbaikan card dan konten */
        .card-body {
            padding: 1rem;
        }

        /* 3. Perbaikan tabel agar bisa di-scroll dengan benar */
        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* 4. Perbaikan form controls */
        .form-control, .form-select {
            max-width: 100%;
            box-sizing: border-box;
        }

        /* 5. Perbaikan grid system untuk mobile */
        .row {
            margin-left: -0.5rem;
            margin-right: -0.5rem;
        }
        
        .row > * {
            padding-left: 0.5rem;
            padding-right: 0.5rem;
        }
        
        /* 6. Perbaikan untuk modal di mobile */
        .modal-dialog {
            margin: 0.5rem;
        }
        
        .modal-content {
            border-radius: 12px;
        }

        /* 7. Perbaikan untuk custom dropdown di mobile */
        .custom-dropdown-options {
            max-width: 100vw;
            left: 0;
            right: 0;
        }

        /* 8. Perbaikan untuk tombol agar tidak terlalu kecil */
        /* .btn {
            min-height: 44px; 
            display: inline-flex;
            align-items: center;
            justify-content: center;
        } */

        /* 9. Perbaikan untuk input fields */
        input, select, textarea {
            font-size: 16px !important;
        }

        /* 10. Perbaikan untuk section dengan banyak konten */
        .app-view {
            min-height: calc(100vh - 120px);
        }

        /* 11. Perbaikan untuk card di dashboard agar tidak terlalu tinggi */
        .card-balance {
            font-size: 1.5rem;
        }

        /* 12. Perbaikan untuk history cards di mobile */
        .history-card {
            margin-bottom: 0.75rem;
            padding: 0.75rem;
        }
        
        .history-card-header {
            flex-direction: column;
            align-items: flex-start;
        }
        
        .history-card-amount {
            margin-top: 0.5rem;
            margin-left: 0;
            align-self: flex-end;
        }

        /* 13. Perbaikan untuk account cards di mobile */
        .account-card {
            flex-direction: column;
            align-items: flex-start;
        }
        
        .account-card-info {
            margin-bottom: 0.75rem;
            width: 100%;
        }
        
        .account-card .action-buttons {
            align-self: flex-end;
        }

        /* 14. Perbaikan untuk form sections */
        .form-section-block {
            padding: 1rem;
            margin-bottom: 1rem;
        }
        
        .form-section-block .row {
            margin-left: -0.25rem;
            margin-right: -0.25rem;
        }
        
        .form-section-block .row > * {
            padding-left: 0.25rem;
            padding-right: 0.25rem;
        }

        /* 15. Perbaikan untuk charts */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        canvas {
            max-width: 100%;
            height: auto !important;
        }

        /* 16. Perbaikan untuk content topbar */
        .content-topbar {
            padding: 1rem 1rem;
            margin-bottom: 1.5rem;
        }

        /* 17. Perbaikan untuk savings dan debt cards */
        .savings-goal-card, .debt-card {
            margin-bottom: 1rem;
        }
        
        .savings-goal-card .card-body, 
        .debt-card .card-body {
            padding: 1rem;
        }

        /* 18. Perbaikan untuk button groups di mobile */
        .btn-group-vertical.w-100 .btn {
            border-radius: 0.375rem !important;
            margin-bottom: 0.25rem;
        }
        .btn-group-vertical.w-100 .btn:last-child {
            margin-bottom: 0;
        }

        /* 19. Perbaikan untuk action buttons di tabel */
        .action-buttons {
            display: flex;
            flex-wrap: nowrap;
        }
        
        .action-buttons .btn {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
        }

        /* ========================================= */
        /* === [CSS BARU] FORM CATAT TRANSAKSI   === */
        /* ========================================= */

        /* 1. CSS untuk Tab Tipe Transaksi */
        #tx-type-selector-wrapper {
            padding-bottom: 0.75rem; 
        }
        #tx-type-selector {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 0.25rem;
            background-color: #e9ecef;
        }
        #tx-type-selector .nav-link {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-semibold);
            color: var(--text-gray);
            border-radius: 6px;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        #tx-type-selector .nav-link.active {
            background-color: var(--sidebar-link-active); /* Hijau Sage */
            color: #FFFFFF;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        #tx-type-selector .nav-link:not(.active):hover {
            color: var(--text-dark);
        }

        /* 2. CSS untuk Input Jumlah yang Menonjol */
        #amount.form-control-lg {
            font-size: 1.75rem; /* Lebih besar */
            font-weight: var(--font-weight-bold);
            color: var(--sidebar-link-active);
            padding-left: 0.5rem;
        }
        
        /* 3. CSS untuk Switch PayLater/Hutang */
        #tx-switch-paylater-wrapper,
        #tx-switch-debt-wrapper {
            display: none; /* Sembunyi by default, JS akan menampilkan */
        }
        #tx-switch-paylater-wrapper.active,
        #tx-switch-debt-wrapper.active {
            display: block; /* JS akan menambah class .active */
        }
        .form-switch .form-check-label {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-normal);
            color: var(--text-dark);
        }
        /* --- Akhir CSS Baru --- */


        /* Media Query untuk Tablet & Mobile */
        @media (max-width: 992px) {
            #sidebar {
                left: calc(var(--sidebar-width) * -1); 
            }
            #sidebar.active {
                left: 0;
            }
            #main-content {
                padding-left: 0;
            }
            #sidebar-toggle {
                display: block;
            }
            #page-title {
                font-size: var(--font-size-xl);
            }
        }
        
        @media (min-width: 768px) {
            .container-fluid {
                padding-left: 1.5rem;
                padding-right: 1.5rem;
            }
            
            .card-body {
                padding: 1.5rem;
            }
            
            .row {
                margin-left: -0.75rem;
                margin-right: -0.75rem;
            }
            
            .row > * {
                padding-left: 0.75rem;
                padding-right: 0.75rem;
            }
            
            .card-balance {
                font-size: var(--font-size-display);
            }
            
            .btn-group-vertical.w-100 {
                flex-direction: row;
                width: auto;
            }
            
            .btn-group-vertical.w-100 .btn {
                border-radius: 0.375rem !important;
                margin-bottom: 0;
                margin-right: 0.25rem;
            }
            
            .btn-group-vertical.w-100 .btn:last-child {
                margin-right: 0;
            }
            
            .history-cards-view {
                display: none;
            }
            
            .history-desktop-view {
                display: block;
            }
        }

        @media (max-width: 768px) {
            #accounts-list-container {
                grid-template-columns: 1fr; 
            }
            .account-card {
                padding: 1rem;
            }
            .account-card .account-name {
                font-size: var(--font-size-base);
            }
            .account-card .account-balance {
                font-size: var(--font-size-sm);
            }
            
            /* --- [CSS BARU] Logika Hybrid di Mobile --- */
            .history-desktop-view {
                display: none; /* Sembunyikan tabel di mobile */
            }
            .history-cards-view {
                display: block; /* Tampilkan kartu di mobile */
            }
            /* --- Akhir CSS Hybrid --- */
        }
        
        @media (min-width: 576px) and (max-width: 767px) {
            .col-lg-4, .col-md-6 {
                margin-bottom: 1rem;
            }
        }
    </style>
</head>
<body>

    <div class="wrapper">
        
        <aside id="sidebar">
            <div class="sidebar-header">
                <span class="sidebar-title">
                    <i class="bi bi-wallet2"></i>Keuanganku
                </span>
                <span class="sidebar-tagline">
                    by falhouse
                </span>
            </div>
            
            <ul class="sidebar-nav">
                <li>
                    <a href="#" class="sidebar-link active" data-target-view="dashboard-view">
                        <i class="bi bi-grid-fill"></i> Dashboard
                    </a>
                </li>
                <li>
                    <a href="#" class="sidebar-link" data-target-view="tracking-view">
                        <i class="bi bi-plus-circle-fill"></i> Catat Transaksi
                    </a>
                </li>
                <li>
                    <a href="#" class="sidebar-link" data-target-view="accounts-view">
                        <i class="bi bi-credit-card-fill"></i> Akun Saya
                    </a>
                </li>
                <li>
                    <a href="#" class="sidebar-link" data-target-view="budgeting-view">
                        <i class="bi bi-pie-chart-fill"></i> Budgeting
                    </a>
                </li>
                <li>
                    <a href="#" class="sidebar-link" data-target-view="history-view">
                        <i class="bi bi-clock-history"></i> Riwayat
                    </a>
                </li>
                <li>
                    <a href="#" class="sidebar-link" data-target-view="savings-view">
                        <i class="bi bi-piggy-bank-fill"></i> Tabungan
                    </a>
                </li>
                <li>
                    <a href="#" class="sidebar-link" data-target-view="debt-view">
                        <i class="bi bi-calendar-x-fill"></i> Hutang
                    </a>
                </li>
                <li>
                    <a href="#" class="sidebar-link" data-target-view="settings-view">
                        <i class="bi bi-gear-fill"></i> Pengaturan
                    </a>
                </li>
            </ul>
        </aside>

        <div class="sidebar-overlay"></div>

        <div id="main-content">
            
            <nav class="content-topbar">
                <div class="d-flex align-items-center">
                    <button class="btn btn-outline-secondary me-3" id="sidebar-toggle" type="button">
                        <i class="bi bi-list"></i>
                    </button>
                    <h2 class="mb-0" id="page-title">Dashboard</h2>
                </div>
            </nav>

            <div class="container-fluid px-0 px-md-3">
                
                <section id="dashboard-view" class="app-view active">
                    <div class="row g-3 g-md-4 mb-3 mb-md-4">
                        <div class="col-12 col-md-6 col-lg-4">
                            <div class="card shadow-sm">
                                <div class="card-body">
                                    <h5 class="card-title text-success mb-2"><i class="bi bi-arrow-down-circle"></i> Total Pemasukan</h5>
                                    <p class="card-balance text-success" id="total-income">Rp 0</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-lg-4">
                            <div class="card shadow-sm">
                                <div class="card-body">
                                    <h5 class="card-title text-danger mb-2"><i class="bi bi-arrow-up-circle"></i> Total Pengeluaran</h5>
                                    <p class="card-balance text-danger" id="total-expense">Rp 0</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6 col-lg-4">
                            <div class="card shadow-sm">
                                <div class="card-body">
                                    <h5 class="card-title text-primary mb-2"><i class="bi bi-wallet"></i> Total Saldo Akun</h5>
                                    <p class="card-balance text-primary" id="current-balance">Rp 0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row g-3 g-md-4 mb-3 mb-md-4">
                        <div class="col-12 col-lg-7">
                            <div class="card shadow-sm">
                                <div class="card-body">
                                    <h5 class="mb-3">Pemasukan vs Pengeluaran</h5>
                                    <div class="chart-container">
                                        <canvas id="incomeExpenseChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-lg-5">
                            <div class="card shadow-sm">
                                <div class="card-body">
                                    <h5 class="mb-3">Alokasi Pengeluaran</h5>
                                    <div class="chart-container">
                                        <canvas id="expenseChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card shadow-sm">
                        <div class="card-header bg-white border-0 pt-3">
                            <h5 class="mb-0">Transaksi Terakhir</h5>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive"> 
                                <table class="table table-striped table-hover mb-0">
                                    <thead>
                                        <tr>
                                            <th>Tanggal</th> 
                                            <th>Kategori</th> 
                                            <th>Keterangan</th> 
                                            <th>Akun</th> 
                                            <th class="text-end">Jumlah</th> 
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recent-transactions-table"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section id="tracking-view" class="app-view">
                    <div class="row justify-content-center">
                        <div class="col-12">
                            <div class="card shadow-sm" style="border-radius: 20px;">
                                <div class="card-body p-3 p-md-4 p-lg-5">
                                    <h3 class="mb-3 mb-md-4" id="tracking-view-title">Catat Transaksi Baru</h3>
                                    <form id="transaction-form">
                                        
                                        <div class="form-section-block" id="tx-type-selector-wrapper">
                                            <label class="form-label">Tipe Transaksi</label>
                                            <div class="nav nav-pills nav-fill" id="tx-type-selector" role="tablist">
                                                <a class="nav-link active" id="tx-type-expense" data-tx-type="expense" href="#">Pengeluaran</a>
                                                <a class="nav-link" id="tx-type-income" data-tx-type="income" href="#">Pemasukan</a>
                                                <a class="nav-link" id="tx-type-transfer" data-tx-type="transfer" href="#">Transfer</a>
                                            </div>
                                        </div>
                                        
                                        <div class="form-section-block">
                                            <label for="amount" class="form-label">Jumlah</label>
                                            <div class="input-group">
                                                <span class="input-group-text">Rp</span>
                                                <input type="text" class="form-control form-control-lg" id="amount" placeholder="0" required inputmode="numeric" data-currency-input="true">
                                            </div>
                                        </div>

                                        <div class="form-section-block">
                                            <div class="row g-2 g-md-3">
                                                
                                                <div class="col-12 col-md-6 form-field-group" id="source-account-wrapper">
                                                    <label for="source-account-custom" class="form-label">Akun Sumber (Bayar Dari)</label>
                                                    <div class="custom-dropdown" id="source-account-custom">
                                                        <div class="custom-dropdown-selected">
                                                            <span class="placeholder">Pilih Akun Sumber...</span>
                                                            <i class="bi bi-arrow-repeat"></i>
                                                        </div>
                                                        <div class="custom-dropdown-options"></div>
                                                    </div>
                                                    <input type="hidden" id="source-account"> 
                                                </div>
                                                
                                                <div class="col-12 col-md-6 form-field-group hidden" id="destination-account-wrapper">
                                                    <label for="destination-account-custom" class="form-label">Akun Tujuan (Masuk Ke)</label>
                                                    <div class="custom-dropdown" id="destination-account-custom">
                                                        <div class="custom-dropdown-selected">
                                                            <span class="placeholder">Pilih Akun Tujuan...</span>
                                                            <i class="bi bi-chevron-down"></i>
                                                        </div>
                                                        <div class="custom-dropdown-options"></div>
                                                    </div>
                                                    <input type="hidden" id="destination-account"> 
                                                </div>

                                                <div class="col-12 col-md-6 form-field-group" id="category-wrapper">
                                                    <label for="category" class="form-label">Kategori</label>
                                                    <select class="form-select" id="category" required>
                                                        <option value="Makanan">Makanan</option>
                                                        <option value="Transportasi">Transportasi</option>
                                                        <option value="Tagihan">Tagihan</option>
                                                        <option value="Hiburan">Hiburan</option>
                                                        <option value="Belanja">Belanja</option>
                                                        <option value="Tabungan">Tabungan</option>
                                                        <option value="Bayar Hutang">Bayar Hutang</option>
                                                        <option value="Lainnya">Lainnya</option>
                                                    </select>
                                                    
                                                    <div class="form-check form-switch mt-2" id="tx-switch-paylater-wrapper">
                                                        <input class="form-check-input" type="checkbox" role="switch" id="tx-switch-paylater">
                                                        <label class="form-check-label" for="tx-switch-paylater">Bayar Nanti (PayLater)?</label>
                                                    </div>
                                                </div>
                                                
                                                <div class="col-12 col-md-6 form-field-group hidden" id="category-income-wrapper">
                                                    <label for="category-income" class="form-label">Kategori</label>
                                                    <select class="form-select" id="category-income" required>
                                                        <option value="Gaji">Gaji</option>
                                                        <option value="Bonus">Bonus</option>
                                                        <option value="Freelance">Freelance</option>
                                                        <option value="Hadiah">Hadiah</option>
                                                        <option value="Hasil Tabungan">Hasil Tabungan</option>
                                                        <option value="Lainnya">Lainnya</option>
                                                    </select>
                                                    
                                                    <div class="form-check form-switch mt-2" id="tx-switch-debt-wrapper">
                                                        <input class="form-check-input" type="checkbox" role="switch" id="tx-switch-debt">
                                                        <label class="form-check-label" for="tx-switch-debt">Ini adalah Uang Pinjaman?</label>
                                                    </div>
                                                </div>

                                                <div class="col-12 col-md-6">
                                                    <label for="date" class="form-label">Tanggal</label>
                                                    <input type="date" class="form-control" id="date" required>
                                                </div>

                                                <div class="col-12">
                                                    <label for="description" class="form-label">Keterangan</label>
                                                    <input type="text" class="form-control" id="description" placeholder="Contoh: Kopi, Bayar Listrik, Gaji November">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-12 form-field-group hidden" id="expense-debt-wrapper">
                                            <div class="form-section-block" style="background-color: #fff8f8;">
                                                <label for="expense-select-debt" class="form-label">Bayar Hutang Kepada:</label>
                                                <select class="form-select" id="expense-select-debt"></select>
                                            </div>
                                        </div>
                                        
                                        <div class="col-12 form-field-group hidden" id="debt-details-wrapper">
                                            <div class="form-section-block" style="background-color: #f6f9ff;">
                                                <h5 class="mb-3">Detail Pinjaman/Hutang</h5>
                                                <div class="row g-2 g-md-3">
                                                    <div class="col-12 col-md-6">
                                                        <label for="debt-lender" class="form-label">Pemberi Pinjaman / Penyedia</label>
                                                        <input type="text" class="form-control" id="debt-lender" placeholder="Contoh: Shopee, Kredivo, Teman">
                                                    </div>
                                                    <div class="col-12 col-md-3">
                                                        <label for="debt-due-date" class="form-label">Jatuh Tempo Pertama</label>
                                                        <input type="date" class="form-control" id="debt-due-date">
                                                    </div>
                                                    <div class="col-12 col-md-3">
                                                        <label for="debt-tenor" class="form-label">Tempo (Bulan)</label>
                                                        <input type="number" class="form-control" id="debt-tenor" placeholder="Cth: 1, 6, 12" value="1" min="1">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <hr class="my-3 my-md-4">

                                        <div class="d-flex justify-content-between align-items-center flex-column flex-md-row">
                                            <div class="mb-2 mb-md-0">
                                                <button type="submit" class="btn btn-brand-primary" id="btn-submit-transaction">
                                                    <i class="bi bi-check-circle-fill"></i> Simpan
                                                </button>
                                                <button type="button" class="btn btn-secondary" id="btn-cancel-edit">
                                                    Batal Edit
                                                </button>
                                            </div>
                                            <div class="form-check form-switch">
                                                <input class="form-check-input" type="checkbox" role="switch" id="check-add-another">
                                                <label class="form-check-label" class="form-check-label" for="check-add-another">Simpan & Tambah Lagi</label>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="accounts-view" class="app-view">
                    <div class="row">
                        <div class="col-12 mb-3 mb-md-4">
                            <div class="card shadow-sm">
                                <div class="card-header bg-white border-0 pt-3 pb-3">
                                    <div class="d-flex justify-content-between align-items-center flex-column flex-md-row">
                                        <h5 class="mb-2 mb-md-0">Daftar Akun Saya</h5>
                                        <button class="btn btn-brand-primary" id="btn-open-account-modal">
                                            <i class="bi bi-plus-circle-fill me-2"></i>Tambah Akun Baru
                                        </button>
                                    </div>
                                </div>
                                <div class="card-body p-2 p-md-3 p-lg-4">
                                    <div id="accounts-list-container">
                                        </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="budgeting-view" class="app-view">
                    <div class="card shadow-sm mb-3 mb-md-4">
                       <div class="card-body p-3 p-md-4">
                           <h5 class="mb-3">Atur Anggaran Kategori (untuk <span id="budget-month-display">...</span>)</h5>
                           
                           <div class="row g-2 g-md-3 mb-3">
                               <div class="col-12 col-md-5">
                                   <label for="budget-month-select" class="form-label">Pilih Bulan Anggaran:</label>
                                   <input type="month" class="form-control" id="budget-month-select">
                               </div>
                               <div class="col-12 col-md-5 text-md-start d-flex align-items-end">
                                   <button class="btn btn-outline-secondary w-100" id="btn-copy-last-month" style="display: none;">
                                       <i class="bi bi-clipboard-plus-fill me-2"></i> Salin Budget Bulan Lalu
                                   </button>
                               </div>
                           </div>
                           
                           <hr>

                           <form id="budget-form" class="row g-2 g-md-3 align-items-end mt-4">
                               <div class="col-12 col-md-5">
                                   <label for="budget-category" class="form-label">Kategori</label>
                                   <select class="form-select" id="budget-category">
                                       </select>
                               </div>
                               <div class="col-12 col-md-5">
                                   <label for="budget-amount" class="form-label">Target Anggaran (Rp)</label>
                                    <input type="text" class="form-control" id="budget-amount" placeholder="Contoh: 1.000.000" required inputmode="numeric" data-currency-input="true">
                               </div>
                               <div class="col-12 col-md-2">
                                   <button type="submit" class="btn btn-brand-primary w-100">Set</button>
                               </div>
                           </form>
                       </div>
                   </div>

                   <div id="budget-list" class="row g-3 g-md-4">
                       </div>
               </section>

                <section id="history-view" class="app-view">
                    <div class="card shadow-sm mb-3 mb-md-4">
                        <div class="card-body p-3 p-md-4">
                            <h5 class="mb-3">Filter Riwayat Transaksi</h5>
                            <div class="row g-2 g-md-3">
                                <div class="col-12 col-lg-3 col-md-6">
                                    <label for="search-history" class="form-label">Cari Keterangan/Kategori</label>
                                    <input type="search" class="form-control" id="search-history" placeholder="Contoh: Makan siang...">
                                </div>
                                <div class="col-12 col-lg-3 col-md-6">
                                    <label for="history-filter-type" class="form-label">Tipe Transaksi</label>
                                    <select class="form-select" id="history-filter-type">
                                        <option value="all" selected>Semua Tipe</option>
                                        <option value="income">Pemasukan</option>
                                        <option value="expense">Pengeluaran</option>
                                        <option value="transfer">Transfer</option>
                                    </select>
                                </div>
                                <div class="col-12 col-lg-3 col-md-6">
                                    <label for="history-filter-account" class="form-label">Akun</label>
                                    <select class="form-select" id="history-filter-account">
                                        <option value="all" selected>Semua Akun</option>
                                        </select>
                                </div>
                                <div class="col-12 col-lg-3 col-md-6">
                                    <label for="history-filter-date-start" class="form-label">Rentang Tanggal</label>
                                    <div class="input-group">
                                        <input type="date" class="form-control" id="history-filter-date-start" title="Tanggal Mulai">
                                        <input type="date" class="form-control" id="history-filter-date-end" title="Tanggal Akhir">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card shadow-sm history-desktop-view">
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover mb-0">
                                    <thead>
                                        <tr>
                                            <th>Tanggal</th> 
                                            <th>Tipe</th> 
                                            <th>Kategori</th> 
                                            <th>Keterangan</th> 
                                            <th>Akun</th> 
                                            <th class="text-end">Jumlah</th> 
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="history-transactions-table">
                                        </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="history-cards-view" id="history-transactions-cards">
                        </div>
                </section>
                
                <section id="savings-view" class="app-view">
                    <div class="card shadow-sm mb-3 mb-md-4">
                        <div class="card-body p-3 p-md-4">
                            <h5 class="mb-3">Buat Tujuan Tabungan Baru</h5>
                            <form id="savings-goal-form" class="row g-2 g-md-3 align-items-end">
                                <div class="col-12 col-md-4">
                                    <label for="goal-name" class="form-label">Nama Tujuan</label>
                                    <input type="text" class="form-control" id="goal-name" placeholder="Contoh: Laptop Baru" required>
                                </div>
    
                                <div class="col-12 col-md-3">
                                    <label for="goal-icon" class="form-label">Pilih Ikon</label>
                                    <select class="form-select" id="goal-icon">
                                        <option value="bi-piggy-bank-fill" selected>Tabungan (Default)</option>
                                        <option value="bi-laptop-fill">Elektronik / Laptop</option>
                                        <option value="bi-car-front-fill">Kendaraan</option>
                                        <option value="bi-house-heart-fill">Rumah / Properti</option>
                                        <option value="bi-airplane-fill">Liburan</option>
                                        <option value="bi-ring">Pernikahan</option>
                                        <option value="bi-gift-fill">Hadiah</option>
                                        <option value="bi-cash-coin">Dana Darurat</option>
                                        <option value="bi-mortarboard-fill">Pendidikan</option>
                                        <option value="bi-box-seam-fill">Lainnya</option>
                                    </select>
                                </div>
    
                                <div class="col-12 col-md-3">
                                    <label for="goal-target" class="form-label">Target (Opsional) (Rp)</label>
                                    <input type="text" class="form-control" id="goal-target" placeholder="Contoh: 10.000.000" inputmode="numeric" data-currency-input="true">
                                </div>
                                <div class="col-12 col-md-2">
                                    <button type="submit" class="btn btn-brand-primary w-100">Buat</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div id="savings-goal-list" class="row g-3 g-md-4">
                    </div>
                </section>
                
                <section id="debt-view" class="app-view">
                    <div class="row">
                        <div class="col-12 mb-3 mb-md-4">
                            <h5 class="mb-3">Daftar Hutang Aktif</h5>
                            <div id="debt-list" class="row g-3 g-md-4">
                                </div>
                        </div>
                    </div>
                </section>

                <section id="settings-view" class="app-view">
                    <div class="row">
                        <div class="col-12 col-lg-6 mb-3 mb-md-4">
                            <div class="card shadow-sm">
                                <div class="card-body p-3 p-md-4">
                                    <h5 class="mb-3"><i class="bi bi-box-arrow-up-right me-2"></i>Ekspor Data</h5>
                                    <p class="text-muted">Simpan semua data Anda ke dalam file JSON sebagai backup.</p>
                                    <button class="btn btn-brand-primary" id="btn-export-data">
                                        <i class="bi bi-download me-2"></i> Unduh File Backup
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-lg-6 mb-3 mb-md-4">
                            <div class="card shadow-sm">
                                <div class="card-body p-3 p-md-4">
                                    <h5 class="mb-3"><i class="bi bi-box-arrow-in-down-left me-2"></i>Impor Data</h5>
                                    <p class="text-muted">Pulihkan data dari file backup JSON. Ini akan <strong class="text-danger">menimpa semua data</strong> yang ada.</p>
                                    <div class="mb-3">
                                        <label for="import-file" class="form-label">Pilih file .json backup Anda:</label>
                                        <input class="form-control" type="file" id="import-file" accept="application/json">
                                    </div>
                                    <button class="btn btn-warning w-100" id="btn-import-data" disabled>
                                        <i class="bi bi-upload me-2"></i> Impor dan Timpa Data
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-12">
                            <div class="card shadow-sm border-danger">
                                <div class="card-body p-3 p-md-4">
                                    <h5 class="mb-3 text-danger"><i class="bi bi-exclamation-triangle-fill me-2"></i>Area Berbahaya</h5>
                                    <p class="text-muted">Tindakan ini akan menghapus **semua** data Anda secara permanen. Tindakan ini tidak dapat dibatalkan.</p>
                                    <button class="btn btn-danger w-100" id="btn-clear-data">
                                        <i class="bi bi-trash-fill me-2"></i> Hapus Semua Data
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

            </div> 
        </div> 
    </div> 
    
    <div class="modal fade" id="account-modal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="account-modal-title">Tambah Akun Baru</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="account-form">
                        <input type="hidden" id="account-id-edit">
                        <div class="mb-3">
                            <label for="account-name" class="form-label">Nama Akun</label>
                            <input type="text" class="form-control" id="account-name" placeholder="Contoh: BCA, Gopay, Tunai" required>
                        </div>
                        
                        <div class="mb-3">
                            <label for="account-icon" class="form-label">Pilih Ikon</label>
                            <select class="form-select" id="account-icon">
                                <option value="bi-wallet2" selected>Dompet (Default)</option>
                                <option value="bi-bank">Bank</option>
                                <option value="bi-cash">Uang Tunai</option>
                                <option value="bi-credit-card-fill">Kartu Kredit/PayLater</option>
                                <option value="bi-phone-fill">E-Wallet (Gopay, OVO)</option>
                                <option value="bi-piggy-bank-fill">Tabungan</option>
                                <option value="bi-safe-fill">Simpanan Jangka Panjang</option>
                                <option value="bi-building">Investasi / Aset</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="account-initial-balance" class="form-label">Saldo Awal (Rp)</label>
                            <input type="text" class="form-control" id="account-initial-balance" placeholder="0" inputmode="numeric" data-currency-input="true">
                            <small class="form-text text-muted">Hanya diisi jika ini akun baru & sudah ada saldonya.</small>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="btn-cancel-account-edit" style="display: none;">
                        Batal Edit
                    </button>
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Tutup</button>
                    <button type="button" class="btn btn-brand-primary" id="btn-submit-account">
                        <i class="bi bi-plus-circle"></i> Tambah Akun
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="add-savings-modal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="add-savings-modal-title">Tambah Tabungan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="add-savings-form">
                        <p>Menabung untuk: <strong id="modal-goal-name"></strong></p>
                        
                        <div class="mb-3">
                            <label for="modal-savings-source-account-custom" class="form-label">Ambil Dari Akun:</label>
                            <div class="custom-dropdown" id="modal-savings-source-account-custom">
                                <div class="custom-dropdown-selected">
                                    <span class="placeholder">Pilih Akun...</span>
                                    <i class="bi bi-chevron-down"></i>
                                </div>
                                <div class="custom-dropdown-options"></div>
                            </div>
                            <input type="hidden" id="modal-savings-source-account"> 
                        </div>
                        
                        <div class="mb-3">
                            <label for="modal-savings-amount" class="form-label">Jumlah (Rp)</label>
                            <input type="text" class="form-control" id="modal-savings-amount" required inputmode="numeric" data-currency-input="true">
                        </div>

                        <p class="form-text">
                            Catatan: Menambah tabungan akan otomatis membuat transaksi 
                            <strong class="text-danger">pengeluaran</strong> baru 
                            dengan kategori "Tabungan".
                        </p>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-brand-primary" id="btn-add-savings">Simpan</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="spend-savings-modal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="spend-savings-modal-title">Gunakan/Ambil Tabungan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="spend-savings-form">
                        <p>Mengambil dari: <strong id="modal-spend-goal-name"></strong></p>
                        <p class="mb-3">Tersimpan saat ini: <strong id="modal-spend-goal-current" class="text-success"></strong></p>
                        
                        <div class="mb-3">
                            <label for="modal-spend-destination-account-custom" class="form-label">Masukkan Ke Akun:</label>
                            <div class="custom-dropdown" id="modal-spend-destination-account-custom">
                                <div class="custom-dropdown-selected">
                                    <span class="placeholder">Pilih Akun...</span>
                                    <i class="bi bi-chevron-down"></i>
                                </div>
                                <div class="custom-dropdown-options"></div>
                            </div>
                            <input type="hidden" id="modal-spend-destination-account"> 
                        </div>
                        
                        <div class="mb-3">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <label for="modal-spend-amount" class="form-label mb-0">Jumlah (Rp)</label>
                                <button class="btn btn-link btn-sm p-0" type="button" id="btn-spend-use-all">Gunakan Semua</button>
                            </div>
                            <input type="text" class="form-control" id="modal-spend-amount" required inputmode="numeric" data-currency-input="true">
                        </div>

                        <p class="form-text">
                            Catatan: Mengambil tabungan akan otomatis membuat transaksi 
                            <strong class="text-success">pemasukan</strong> baru 
                            dengan kategori "Hasil Tabungan".
                        </p>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-success" id="btn-spend-savings">Ambil Tabungan</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="pay-debt-modal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="pay-debt-modal-title">Bayar Hutang</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="pay-debt-form">
                        <p>Membayar hutang kepada: <strong id="modal-debt-lender"></strong></p>
                        <p class="mb-3">Sisa hutang saat ini: <strong id="modal-debt-remaining"></strong></p>
                        
                        <div class="mb-3">
                            <label for="modal-debt-source-account-custom" class="form-label">Bayar Dari Akun:</label>
                             <div class="custom-dropdown" id="modal-debt-source-account-custom">
                                <div class="custom-dropdown-selected">
                                    <span class="placeholder">Pilih Akun...</span>
                                    <i class="bi bi-chevron-down"></i>
                                </div>
                                <div class="custom-dropdown-options"></div>
                            </div>
                            <input type="hidden" id="modal-debt-source-account"> 
                        </div>
                        
                        <div class="mb-3">
                            <label for="modal-debt-payment-amount" class="form-label">Jumlah Pembayaran (Rp)</label>
                            <input type="text" class="form-control" id="modal-debt-payment-amount" required inputmode="numeric" data-currency-input="true">
                        </div>

                        <p class="form-text">
                            Catatan: Membayar hutang akan otomatis membuat transaksi 
                            <strong class="text-danger">pengeluaran</strong> baru 
                            dengan kategori "Bayar Hutang".
                        </p>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-brand-primary" id="btn-add-debt-payment">Bayar</button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script src="app.js"></script>
        
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    </script>
    </body>
</html>